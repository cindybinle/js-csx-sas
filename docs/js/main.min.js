function isJsonString(e){try{JSON.parse(e)}catch(t){return!1}return!0}function xmlToJson(e){var t={};if(1==e.nodeType){if(e.attributes.length>0){t["@attributes"]={};for(var n=0;n<e.attributes.length;n++){var o=e.attributes.item(n);t["@attributes"][o.nodeName]=o.nodeValue}}}else 3==e.nodeType&&(t=e.nodeValue);if(e.hasChildNodes())for(var i=0;i<e.childNodes.length;i++){var r=e.childNodes.item(i),a=r.nodeName;if("undefined"==typeof t[a])t[a]=xmlToJson(r);else{if("undefined"==typeof t[a].push){var s=t[a];t[a]=[],t[a].push(s)}t[a].push(xmlToJson(r))}}return t}function randomString(e,t){t=t||"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";for(var n="",o=0;e>o;o++){var i=Math.floor(Math.random()*t.length);n+=t.substring(i,i+1)}return n}!function(){var e=angular.module("ng.jsoneditor",[]);e.constant("ngJsoneditorConfig",{}),e.directive("ngJsoneditor",["ngJsoneditorConfig","$timeout",function(e,t){var n=e||{};return{restrict:"A",require:"ngModel",scope:{options:"=",ngJsoneditor:"=",preferText:"="},link:function(e,o,i,r){function a(i){var a=angular.extend({},n,i),l=angular.extend({},a,{change:function(){"undefined"!=typeof s&&t.cancel(s),s=t(function(){d&&(u=!0,r.$setViewValue(e.preferText===!0?d.getText():d.get()),u=!1,a&&a.hasOwnProperty("change")&&a.change())},a.timeout||100)}});o.html("");var c=new JSONEditor(o[0],l);return e.ngJsoneditor instanceof Function&&t(function(){e.ngJsoneditor(c)}),c}var s,l,d,u=!1;if(!angular.isDefined(window.JSONEditor))throw new Error("Please add the jsoneditor.js script first!");e.$watch("options",function(t,n){for(var o in t)if(t.hasOwnProperty(o)){var i=t[o];if(t[o]!==n[o])if("mode"===o)d.setMode(i);else{if("name"!==o)return d=a(t),void e.updateJsonEditor();d.setName(i)}}},!0),e.$on("$destroy",function(){}),e.updateJsonEditor=function(n){u||("undefined"!=typeof l&&t.cancel(l),l=t(function(){e.preferText!==!0||angular.isObject(r.$viewValue)?d.set(r.$viewValue||{}):d.setText(r.$viewValue||"{}")},e.options.timeout||100))},d=a(e.options),e.options.hasOwnProperty("expanded")&&t(e.options.expanded?function(){d.expandAll()}:function(){d.collapseAll()},(e.options.timeout||100)+100),r.$render=e.updateJsonEditor,e.$watch(function(){return r.$modelValue},e.updateJsonEditor,!0)}}}])}();var json={Array:[1,2,3],Boolean:!0,Null:null,Number:123,Object:{a:"b",c:"d"},String:"Hello World"},Module=angular.module("jsoneditor",["ng.jsoneditor","angularResizable"]);Module.config(["$compileProvider",function(e){e.aHrefSanitizationWhitelist(/^\s*(|blob|):/)}]),Module.controller("controller",["$scope","$timeout","$window",function(e,t,n){function o(){if("undefined"!=typeof Storage){var e=localStorage.getItem("json_editor_online_tl");if(e){var t=JSON.parse(e);return"undefined"!=typeof t.list&&t.list.map(function(e){e.isChecked=!1}),t}return{list:[]}}}var i=new Date,r=json;o().list.length>0&&(r=o().list[o().list.length-1]),e.obj={data:r,options:{mode:"code"},listChecked:[],file:null,fileDownload:null,fileName:i.getDate()+"_"+i.getMonth()+"_"+i.getFullYear()+"_"+i.getHours()+"_"+i.getMinutes()+".json"},e.obj2={data:json,options:{mode:"tree"}},e.alert={errorDisplay:!1,errorText:"",successDisplay:!1,successText:""},e.heightEditor=window.innerHeight-115,window.innerWidth<769&&(e.heightEditor=window.innerHeight/2-53),e.toggleWindowBookmark=!1,e.getListSaved=o().list||[],e.chooseBookmark=-1,e.$watch("obj.file",function(t){t&&isJsonString(t)?(e.obj.data=JSON.parse(t),e.alert.successDisplay=!0,e.alert.successText="Import file success!"):isJsonString(t)||(e.alert.errorDisplay=!0,e.alert.errorText="Format json file wrong, please choose other file!")}),e.$watch("alert.errorDisplay",function(n){n&&t(function(){e.alert={errorDisplay:!1,errorText:"",successDisplay:!1,successText:""}},3e3)}),e.$watch("alert.successDisplay",function(n){n&&t(function(){e.alert={errorDisplay:!1,errorText:"",successDisplay:!1,successText:""}},3e3)}),e.$watch("obj.data",function(t){var o=n.URL||n.webkitURL;e.obj.fileDownload=o.createObjectURL(new Blob([JSON.stringify(t)],{type:"text/plain"}))}),e.formatTime=function(e){return moment(e).fromNow()},e.loadData=function(t,n){e.obj.data=t,e.chooseBookmark=n},e.onClickSave=function(){if("undefined"!=typeof Storage){var t=o(),n=[];"undefined"!=typeof t.list&&(n=t.list),n.push({id:randomString(10),date:new Date,data:e.obj.data}),t.list=n,localStorage.setItem("json_editor_online_tl",JSON.stringify(t)),e.alert.successDisplay=!0,e.alert.successText="Saved!",e.getListSaved=o().list||[]}},e.deleteListLocalStorage=function(){if("undefined"!=typeof Storage){var t=o(),n=[];"undefined"!=typeof t.list&&(n=t.list),e.obj.listChecked.map(function(e){n.map(function(t,o){e==t.id&&n.splice(o,1)})}),t.list=n,localStorage.setItem("json_editor_online_tl",JSON.stringify(t)),e.getListSaved=o().list||[],e.obj.listChecked=[]}},e.onClickListSave=function(){e.toggleWindowBookmark=!0},e.onClickListCloseSave=function(){e.toggleWindowBookmark=!1},e.onCheckedList=function(t,n){if(t)e.obj.listChecked.push(n);else{var o=-1;e.obj.listChecked.map(function(e,t){e==n&&(o=t)}),-1!=o&&e.obj.listChecked.splice(o,1)}},e.getString=function(e){return JSON.stringify(e)}}]),Module.directive("fileread",[function(){return{scope:{fileread:"="},link:function(e,t,n){t.bind("change",function(t){var n=new FileReader;n.onload=function(t){e.$apply(function(){e.fileread=t.target.result})},n.readAsText(t.target.files[0])})}}}]);